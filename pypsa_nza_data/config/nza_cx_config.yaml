#==============================================================================
#   YAML Configuration File (`nza_cx_config.yaml`) for capital expansion
#   planning
#==============================================================================
# LINUX
# python -m pypsa_nza_data.processors.nza_process_dynamic_data \
#   --config pypsa_nza_data/config/nza_process_dynamic_data.yaml \
#   --root /home/reviewer/nz_workspace
#
#   OR
#
# WINDOWS
# python -m pypsa_nza_data.processors.nza_process_dynamic_data ^
#   --config pypsa_nza_data/config/nza_process_dynamic_data.yaml ^
#   --root /home/reviewer/nz_workspace
#==============================================================================

paths:
#   root:                 "/home/pbrun/{{enter sub-dir name}}"  # Linux work-space directory: user spec
    root:                "C:/Users/Public/Documents/Thesis/analysis"  # Windows work-space directory: user spec
    dirpath_static:      "data/processed/static/"
    dirpath_export:      "data/processed/2024/export/cons_MWh/"
    dirpath_import:      "data/processed/2024/import/cons_MWh/"
    dirpath_gen:         "data/processed/2024/gen/cons_MWh/"
    dirpath_g_MWh:       "data/processed/2024/gen/g_MWh/"
    dirpath_g_MW:        "data/processed/2024/gen/g_MW/"
    dirpath_bus:         "data/processed/2024/bus"
    dirpath_load:        "data/processed/2024/load/delta_f1f2/"
    dirpath_f1f2:        "data/processed/2024/delta_f1f2/"
    dirpath_demand:      "data/processed/2024/demand/d_MW"
    dirpath_d_MW:        "data/processed/2024/demand/d_MW"
    dirpath_d_MWh:       "data/processed/2024/demand/d_MWh/"
    dirpath_d:           "data/processed/2024/demand/d_MWh"
    dirpath_costs:       "data/costs/"
    dirpath_networks:    "models/capacity_expansion/edgs/reference/networks/"
    dirpath_base:        "models/capacity_expansion/edgs/reference/demand/"
    dirpath_renewables:  "models/capacity_expansion/renewables/"
    dirpath_mbie:        "data/external/mbie/"
    dirpath_mbie_edgs:   "data/external/mbie_edgs/"
    dirpath_NIWA:        "data/natural resources/wind/"
    dirpath_wind_pu_ann: "wind/wind_data_output/"
    dirpath_wind_pu_mon: "wind/wind_p_pu_monthly/2024/"
    dirpath_solar_pu:    "solar/"
    dirpath_cx_base_demand: "cases/reference/2024/"

filename:
    bus_data:   "busses.csv"
    line_data:  "lines_data.csv"
    link_data:  "links_data.csv"
    gen_data:   "gen_data.csv"
    costs_file: "nz_energy_tech_costs_2023_nzd.yaml"
    wind:       "wind_p_pu_synthetic.csv"
    wind_pu:    "NIWA_bus_p_pu_2024.csv"
    wind_pu_mon: "wind_p_pu_{month_code}.csv"
    NIWA:       "5ySWD-EC-tenm.csv"
    solar:      "solar_PV_p_pu.csv"
    shares:     "electricity_generation_modality.csv"

demand_file_suffix: "_d_MW.csv"

# Date Specifications
start_date: '2024-01-01 00:00:00'
end_date:   '2024-12-31 23:30:00'
frequency:  '30T'  # 1/2 hour
base_year: 2024
start_year: 2024
weather_year: 2024

# Scenario datw
scenario_names: ["constraint", "reference", "environmental", "innovative", "growth"]
scenario: "reference"   
scenario_years: 
    start: 2025
    end  : 2030

# EDGS demand growth factors
demand_scenarios:
    reference:
        2024 : 1.0
        2025 : 1.0266173752310535
        2026 : 1.0449291435613062
        2027 : 1.074947627849661
        2028 : 1.0928157732593962
        2029 : 1.120369685767098
        2030 : 1.1381638940234133
        2031 : 1.158570548367221
        2032 : 1.1787553912507702
        2033 : 1.1987184226740601
        2034 : 1.2204066543438077
        2035 : 1.2446826863832408
        2036 : 1.2706592729513246
        2037 : 1.2973012939001847
        2038 : 1.3246087492298213
        2039 : 1.3517683302526184
        2040 : 1.37818853974122
        2041 : 1.4027603203943315
        2042 : 1.4237584719654959
        2043 : 1.4423413431916203
        2044 : 1.457917436845348
        2045 : 1.4723844731977818
        2046 : 1.4858656808379542
        2047 : 1.4984349969192852
        2048 : 1.5105606900800983
        2049 : 1.520098582871226
        2050 : 1.5294146642020947

# Availability map - hard-coded in nza_cx_customize - must still rewd into program
availability: 
    hydro: 1.0        # Hydro - limited by water availability
    geothermal: 1.01   # Geothermal - baseload, high availability
    gas: 1.0         # Gas - dispatchable on demand
    diesel: 1.0 # Diesel - dispatchable on demand
    wind: 1.0 # Wind - availability from profile, not scalar
    solar_pv: 1.0 # Solar - availability from profile, not scalar

# Capex generator settings
# generator_settings:
#   HYD:
#     extendable: false
#     dispatchable: true
#     active: true
#   DSL:
#     extendable: false
#     dispatchable: true
#     active: true
#   WIND:
#     extendable: true
#     dispatchable: false
#     active: true
#     p_max_pu_file: "wind_p_pu_synthetic.csv"
#     profile_dir: "../renewables/wind/"
#     cap_fraction: 0.8
#   PV:
#     extendable: true
#     dispatchable: false
#     active: true
#     p_max_pu_file: "solar_PV_p_pu.csv"
#     profile_dir: "renewables/solar/"
#     cap_fraction: 0.6
#   GEO:
#     extendable: false
#     dispatchable: true
#     active: true

# Wind generator-site mappings
wind_gen_site_map:
    "GOR": "STH1"
    "NMA": "STH2"
    "BPE": "CKS1"
    "HRP": "CNI1"
    "LTN": "CKS3"
    "TWC": "CNI1"
    "WDV": "CNI2"
    "WIL": "STH3"
    "WVY": "NTH2"
    "WWD": "CKS3"

wind_gen_map:
    GOR:
        turbine: "vestas_V112_3.07MW_82"
        name: "Kaiwera Downs"
        site: "STH1"
    NMA:
        turbine: "vestas_V136_4.2MW"
        name: "White Hill"
        site: "STH2"
    BPE:
        turbine: "vestas_V90-30_3.0MW"
        name: "Tararua Stage 2"
        site: "CKS1"
    HRP:
        turbine: "Siemens Gamesa SWT-DD-120"
        name: "Harapaki"
        site: "CNI1"
    LTN:
        turbine: "vestas_V47_660kW"
        name: "Tararua Stage 1"
        site: "CKS1"
    TWC:
        turbine: "vestas_V90-30_3.0MW"
        name: "Tararua Stage 3"
        site: "CNI1"
    WDV:
        turbine: "vestas_VNM72-1.65MW"
        name: "Te Apiti"
        site: "CNI2"
    WIL:
        turbine: "Siemens SWT-2.3MW-82"
        name: "Mill Creek"
        site: "STH3"
    WVY:
        turbine: "Siemens Gamesa SWT-DD-130"
        name: "Waipipi"
        site: "NTH2"
    WWD:
        turbine: "Siemens SWT-2.3MW-82"
        name: "West Wind I"
        site: "CKS3"

wind_turbine_spec:
    vestas_V112_3.07MW_82:
        v_cut_in : 3
        v_rated: 12
        v_cut_out : 25
    vestas_V136_4.2MW:
        v_cut_in : 3
        v_rated: 12
        v_cut_out : 25
    vestas_V90-30_3.0MW:
        v_cut_in : 4
        v_rated: 15
        v_cut_out : 25
    vestas_V47_660kW:
        v_cut_in: 4
        v_rated: 15
        v_cut_out: 25
    vestas_VNM72-1.65MW:
        v_cut_in: 2.5
        v_rated: 13
        v_cut_out: 32
    Siemens Gamesa SWT-DD-120:
        v_cut_in : 3
        v_rated: 13
        v_cut_out : 25
    Siemens SWT-2.3MW-82:
        v_cut_in : 4
        v_rated: 13.5
        v_cut_out : 25
    Siemens Gamesa SWT-DD-130:
        v_cut_in : 3
        v_rated: 13
        v_cut_out : 25

# Wind mapping - simulation years to NIWA data years
wind_data_year_map:
    2024: 2004
    2025: 2005
    2026: 2006
    2027: 2007
    2028: 2004
    2029: 2005
    2030: 2006
    2031: 2006
    2032: 2004
    2033: 2006
    2034: 2006
    2035: 2007
    2036: 2004
    2037: 2005
    2038: 2006
    2039: 2007
    2040: 2004
    2041: 2005
    2042: 2006
    2043: 2007
    2044: 2004
    2045: 2005
    2046: 2006
    2047: 2007
    2048: 2004
    2049: 2005
    2050: 2006

# Tech shares - 2024
# tech_shares:
#   "wind": 0.1
#   "hydro": 0.59
#   "solar": 0.01
#   "gas": 0.14
#   "geo": 0.16

# # Caoacity factors
# capacity_factors:
#   "wind": 0.40
#   "hydro": 0.50
#   "solar": 0.18
#   "gas": 0.65
#   "geo": 0.90

# # Reserve margins
# reserve_margins:
#   "wind": 0.2
#   "hydro": 0.05
#   "solar": 0.3
#   "gas": 0.1
#   "geo": 0.1


# Capital expansion year mapping - simulation:NIWA
# wind_data_year_map:
#     2024: 2004
#     2025: 2005
#     2026: 2006
#     2027: 2007
#     2028: 2004
#     2029: 2005
#     2030: 2006
#     2031: 2006
#     2032: 2004
#     2033: 2006
#     2034: 2006
#     2035: 2007
#     2036: 2004
#     2037: 2005
#     2038: 2006
#     2039: 2007
#     2040: 2004
#     2041: 2005
#     2042: 2006
#     2043: 2007
#     2044: 2004
#     2045: 2005
#     2046: 2006
#     2047: 2007
#     2048: 2004
#     2049: 2005
#     2050: 2006

# Brownfield expansion factors (existing sites can expand by this multiple)
WIND_EXPANSION_FACTORS: 
    "GOR": 15.0
    "NMA": 15.0
    "BPE": 15.0
    "HRP": 15.0
    "LTN": 15.0
    "TWC": 15.0
    "WDV": 15.0
    "WIL": 15.0
    "WVY": 15.0
    "WWD": 15.0
    
SOLAR_EXPANSION_FACTORS:
    "EDG": 15.0
    "WAI": 15.0
    "MTO": 15.0
    
# Profile mappings for sites without direct data
WIND_PROFILE_MAPPING:
    'INV': 'GOR'  # Invercargill uses Gore wind profile (nearby)
    
SOLAR_PROFILE_MAPPING:
    'HAM': 'EDG'  # Hamilton uses Edgecumbe profile
    'WAI': 'EDG'  # Waipawa uses Edgecumbe (if no direct profile)
    'MTO': 'EDG'  # MaungatÅ«roto uses Edgecumbe (if no direct profile)
    
    

# Greenfield generation sites (NEW locations to consider)
# greenfield_sites:
#   wind:
#     - {name: 'GOR_expansion', bus: 'GOR', max_capacity: 20, cf_profile: 'GOR'}
#     - {name: 'TWC_expansion', bus: 'TWC', max_capacity: 30, cf_profile: 'TWC'}
#     - {name: 'Southland_wind_new', bus: 'INV', max_capacity: 500, cf_profile: 'INV'}
#   solar:
#     - {name: 'Waikato_solar_new', bus: 'HAM', max_capacity: 150, cf_profile: 'HAM'}
#   battery:
#     - {name: 'Auckland_battery', bus: 'OTA', power: 20, energy: 800}  # 4-hour
#     - {name: 'Wellington_battery', bus: 'HAY', power: 15, energy: 600}

# Multi-year settings
# multi_year:
#   start_year: 2025
#   end_year: 205
#   optimization_years: [2025, 2028, 2031, 2035]  # Optimize these years
#   representative_weather_year: 2004  # Use 2015 weather for all years


